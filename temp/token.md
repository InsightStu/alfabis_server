$def with(auth_url=None, token=None)
Title: DSS Token Request




$if session.loggedin == False:
  Secret Token Request
  =====
  You will need a **secret token** to access this system using ITK-SNAP command line tools. To generate a token, please authenticate yourself using one of the methods below:

  <a href="$(auth_url)" class="googlebutton" title="Login with Google"></a>

$elif session.acceptterms == False:
  Distributed Segmentation Service Terms of Use
  =====
  You have authenticated as **$(session.email)**. You must accept the terms of service below before using the DSS system.

    - **This system is not for clinical use**. This software and website are provided strictly for research use. Results generated by using this website and software may not be used for clinical purposes of any kind. 
    - **Human subjects protections**. This software and website send image data over computer networks. The software uses encryption and will take reasonable steps to remove image header fields and rename files so as to remove identifiers. Any data supplied to this software and website must be completely stripped of protected health information, in accordance with the policies of the Institutional Review Board (IRB) or other relevant regulatory body that oversees the user's research.
    - **Open source licenses**. The website and software are provided under the terms of [the GNU General Public License](https://www.gnu.org/licenses/gpl.txt).

  <form class="pure-form pure-form-aligned" action="/acceptterms" method="POST">
      <fieldset>
          <div class="pure-controls">
              <label for="cb" class="pure-checkbox" required>
                  <input name="cb" id="cb" type="checkbox"> I agree to the terms and conditions above
              </label>
              <button type="submit" class="pure-button pure-button-primary">Submit</button>
          </div>
      </fieldset>
  </form>

$else:
  Secret Token
  =====
  You have authenticated as **$(session.email)**.  Your secret token is below. 
  Copy and paste it into <code>itksnap-wt</code> or other DSS-compatible tool.

      $(token) 
